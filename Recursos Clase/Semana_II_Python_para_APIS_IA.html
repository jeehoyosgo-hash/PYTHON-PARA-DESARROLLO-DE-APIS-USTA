<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Curso intensivo de Python 3.11 para estad√≠sticos: Protocolos HTTP, JSON vs Pickle, Pydantic y Entornos Virtuales.">
    <meta name="author" content="Javier Mauricio Sierra">
    <meta name="keywords" content="Python, estad√≠stica, data science, APIs, HTTP, JSON, Pickle, Pydantic, venv, Docker">
    <title>Semana II - Ingenier√≠a de Datos y Despliegue</title>

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">

    <!-- Highlight.js: Syntax highlighting (VS Code dark theme) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif'],
                    },
                    colors: {
                        primary: '#3D008D',
                        secondary: '#ED1E79',
                        navy: '#001A4D',
                        gold: '#FDB913',
                        bg: '#F8FAFC',
                        surface: '#FFFFFF',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background-color: #F8FAFC;
            color: #1E293B;
            scroll-behavior: smooth;
        }

        .code-font {
            font-family: 'Fira Code', monospace;
        }

        /* USTA Gradient Background */
        .usta-gradient {
            background: linear-gradient(140deg, #3D008D 0%, #ED1E79 100%);
        }

        .usta-gradient-hover:hover {
            background: linear-gradient(140deg, #4A00A8 0%, #FF2D8A 100%);
        }

        /* USTA Navy Header */
        .usta-header {
            background: linear-gradient(180deg, #001A4D 0%, #002868 100%);
        }

        /* USTA Card Style */
        .usta-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .usta-card:hover {
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.12);
            transform: translateY(-4px);
        }

        /* USTA Button Style */
        .usta-button {
            background: linear-gradient(140deg, #3D008D 0%, #ED1E79 100%);
            color: white;
            border-radius: 50px;
            padding: 12px 28px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .usta-button:hover {
            background: linear-gradient(140deg, #4A00A8 0%, #FF2D8A 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(61, 0, 141, 0.35);
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        /* Custom scrollbar for code blocks */
        .code-scroll::-webkit-scrollbar {
            height: 8px;
        }

        .code-scroll::-webkit-scrollbar-track {
            background: #2d2d2d;
        }

        .code-scroll::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #3D008D, #ED1E79);
            border-radius: 4px;
        }

        /* Collapsible code block */
        details summary::-webkit-details-marker {
            display: none;
        }

        details summary::marker {
            display: none;
            content: '';
        }

        details[open] .code-toggle-arrow {
            transform: rotate(90deg);
        }

        .code-toggle-arrow {
            transition: transform 0.2s ease;
            display: inline-block;
        }

        /* Highlight.js overrides for seamless dark background */
        .hljs {
            background: transparent !important;
            font-family: 'Fira Code', monospace;
            font-size: 0.85rem;
            line-height: 1.6;
        }

        .step-connector::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, #3D008D, #ED1E79);
            opacity: 0.3;
            z-index: -1;
        }

        .step-connector:last-child::after {
            display: none;
        }

        .active-step .step-circle {
            background: linear-gradient(140deg, #3D008D 0%, #ED1E79 100%);
            color: white;
            border-color: #3D008D;
            box-shadow: 0 4px 15px rgba(61, 0, 141, 0.4);
        }

        .completed-step .step-circle {
            background-color: #10B981;
            color: white;
            border-color: #10B981;
        }

        /* Fade-in animation for content transitions */
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Focus styles for accessibility */
        button:focus-visible {
            outline: 2px solid #ED1E79;
            outline-offset: 2px;
        }

        /* Skip link for keyboard users */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: linear-gradient(140deg, #3D008D 0%, #ED1E79 100%);
            color: white;
            padding: 8px;
            z-index: 100;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Scroll to top button */
        .scroll-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 3.5rem;
            height: 3.5rem;
            background: linear-gradient(140deg, #3D008D 0%, #ED1E79 100%);
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 6px 15px rgba(61, 0, 141, 0.4);
            transition: all 0.3s ease;
            z-index: 50;
            border: none;
        }

        .scroll-to-top.visible {
            display: flex;
        }

        .scroll-to-top:hover {
            background: linear-gradient(140deg, #4A00A8 0%, #FF2D8A 100%);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(61, 0, 141, 0.5);
        }

        /* Sidebar active state */
        .nav-item.active {
            background: linear-gradient(90deg, rgba(61, 0, 141, 0.1) 0%, transparent 100%);
            border-left: 4px solid #ED1E79;
        }

        .nav-item:hover {
            background: linear-gradient(90deg, rgba(61, 0, 141, 0.05) 0%, transparent 100%);
        }

        /* Tip box USTA style */
        .tip-box {
            background: linear-gradient(135deg, rgba(61, 0, 141, 0.08) 0%, rgba(237, 30, 121, 0.08) 100%);
            border: 1px solid rgba(61, 0, 141, 0.2);
        }

        /* Tooltip Styles (adapted from Semana II) */
        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 1px dotted #ED1E79;
            cursor: help;
            color: #3D008D;
            font-weight: 600;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #001A4D;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 100;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.75rem;
            font-weight: normal;
            pointer-events: none;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .tooltip .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #001A4D transparent transparent transparent;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

    <!-- Header & Pipeline Map -->
    <header class="usta-header sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                <div class="flex items-center gap-4">
                    <div class="usta-gradient p-3 rounded-xl shadow-md">
                        <i class="fab fa-python text-xl text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white leading-tight tracking-tight">Ingenier√≠a de Datos con
                            Python</h1>
                        <p class="text-xs text-white/70 font-medium tracking-wide">SESI√ìN 2 ‚Ä¢ PROTOCOLOS Y CALIDAD ‚Ä¢
                            USTA</p>
                    </div>
                </div>
                <nav class="hidden md:flex items-center gap-4 text-sm mt-4 md:mt-0">
                    <div
                        class="flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm hover:bg-white/20 transition-all">
                        <i class="fas fa-network-wired text-yellow-400"></i>
                        <span class="text-white font-medium">HTTP & APIs</span>
                    </div>
                    <div
                        class="flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm hover:bg-white/20 transition-all">
                        <i class="fas fa-file-code text-green-400"></i>
                        <span class="text-white font-medium">JSON vs Pickle</span>
                    </div>
                    <div
                        class="flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm hover:bg-white/20 transition-all">
                        <i class="fas fa-shield-alt text-cyan-400"></i>
                        <span class="text-white font-medium">Pydantic</span>
                    </div>
                    <span
                        class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/20 text-white ml-2 backdrop-blur-sm">
                        ‚è±Ô∏è <span id="time-remaining" class="ml-1 font-bold">120</span> min
                    </span>
                </nav>
            </div>

            <!-- Visual Progress Map -->
            <div class="relative flex justify-between items-center max-w-3xl mx-auto" id="pipeline-container">
                <!-- Steps injected via JS -->
            </div>
        </div>
    </header>

    <div class="flex-grow flex flex-col md:flex-row max-w-7xl mx-auto w-full px-4 sm:px-6 lg:px-8 py-8 gap-8">

        <!-- Sidebar Navigation -->
        <aside class="w-full md:w-64 flex-shrink-0">
            <nav class="space-y-2 sticky top-32" id="module-nav">
                <!-- Nav items injected via JS -->
            </nav>

        </aside>

        <!-- Main Content Area -->
        <main class="flex-grow bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden min-h-[600px]">
            <div id="content-area" class="p-6 md:p-10">
                <!-- Content injected via JS -->
                <div class="flex justify-center items-center h-full">
                    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Tip Pedag√≥gico Fijo -->
    <div class="fixed bottom-4 left-4 md:w-72 tip-box p-4 rounded-xl shadow-lg z-40" id="tip-pedagogico">
        <div class="flex justify-between items-start">
            <div>
                <h4 class="font-bold text-primary text-sm mb-1 flex items-center gap-2">
                    <i class="fas fa-lightbulb text-secondary"></i> Tip Pedag√≥gico
                </h4>
                <p class="text-xs text-gray-700">
                    Este material est√° dise√±ado para estad√≠sticos. No nos enfocamos en desarrollo web, sino en
                    reproducibilidad y an√°lisis robusto.
                </p>
            </div>
            <button onclick="document.getElementById('tip-pedagogico').style.display='none'"
                class="text-primary hover:text-secondary text-lg ml-2 transition-colors"
                aria-label="Cerrar tip">√ó</button>
        </div>
    </div>

    <!-- Scroll to Top Button -->
    <button class="scroll-to-top" id="scrollToTopBtn" aria-label="Volver arriba">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Footer -->
    <footer class="usta-header mt-auto">
        <div class="max-w-7xl mx-auto px-4 py-6 text-center text-sm text-white/80">
            <p class="font-medium">Dise√±ado por <span class="text-white">Javier Mauricio Sierra</span></p>
            <p class="text-xs mt-1 text-white/60">Python 3.11.9 ‚Ä¢ Enfoque Data-Driven ‚Ä¢ USTA</p>
        </div>
    </footer>

    <!-- JavaScript Application Logic -->
    <script>
        // --- DATA STORE ---
        const courseData = {
            modules: [
                {
                    id: "m1",
                    title: "M√≥dulo 1: El Protocolo HTTP",
                    shortTitle: "HTTP & APIs",
                    objective: "Dominar los verbos, c√≥digos de estado y headers para interactuar robustamente con APIs.",
                    duration: "40 min",
                    content: {
                        concept: {
                            title: "La Anatom√≠a de una Petici√≥n HTTP & Autenticaci√≥n",
                            text: "HTTP es el lenguaje universal de la web. Para un Data Scientist, entenderlo es vital para extraer datos (<span class='tooltip'>Scraping<span class='tooltip-text'>Extracci√≥n automatizada de datos desde el HTML de webs.</span></span>/<span class='tooltip'>APIs<span class='tooltip-text'>Interfaz para que programas intercambien datos de forma estructurada.</span></span>) o desplegar modelos (<span class='tooltip'>Flask<span class='tooltip-text'>Framework web ligero (micro) de Python. Ideal para prototipos.</span></span>/<span class='tooltip'>FastAPI<span class='tooltip-text'>Framework moderno de alto rendimiento enfocado en APIs y tipado.</span></span>).<br><br><strong>1. Verbos (La Acci√≥n):</strong><br>‚Ä¢ <strong>GET:</strong> Solicitar datos. <em>Ej: Descargar dataset.</em><br>‚Ä¢ <strong>POST:</strong> Enviar datos. <em>Ej: Inferencia de modelo.</em><br><br><strong>2. Headers & Autenticaci√≥n (El Pase VIP):</strong><br>La mayor√≠a de APIs comerciales requieren identificarse. Los m√©todos m√°s comunes son:<br>‚Ä¢ <strong>Basic Auth:</strong> Usuario y contrase√±a en cada petici√≥n (Inseguro, 'vieja escuela').<br>‚Ä¢ <strong>API Key:</strong> Un c√≥digo √∫nico (token) que te identifica. Se env√≠a en Headers (<code>X-API-Key: abc12345</code>).<br>‚Ä¢ <strong>Bearer Token (OAuth2):</strong> El est√°ndar moderno. Obtienes un token temporal (como una manilla de hotel) que expira.<br><br><strong>3. Status Codes (El Resultado):</strong><br><br><span class='font-bold text-indigo-700'>üü¢ 2xx (√âxito - Todo bien)</span><br>‚Ä¢ <strong>200 OK:</strong> Petici√≥n exitosa est√°ndar.<br>‚Ä¢ <strong>201 Created:</strong> Recurso creado (ej: Usuario registrado).<br>‚Ä¢ <strong>202 Accepted:</strong> Petici√≥n aceptada para proceso en <em>background</em> (ej: Entrenar un modelo pesado).<br><br><span class='font-bold text-orange-600'>üü† 4xx (Error Cliente - Culpa tuya)</span><br>‚Ä¢ <strong>400 Bad Request:</strong> Enviaste datos mal formados (JSON roto).<br>‚Ä¢ <strong>401 Unauthorized:</strong> No tienes credenciales (Token).<br>‚Ä¢ <strong>403 Forbidden:</strong> Tienes token, pero no permisos para esto.<br>‚Ä¢ <strong>404 Not Found:</strong> El endpoint o recurso no existe.<br>‚Ä¢ <strong>422 Unprocessable Entity:</strong> Datos sem√°nticamente err√≥neos (ej: Enviar texto donde va un n√∫mero).<br>‚Ä¢ <strong>429 Too Many Requests:</strong> Calma, est√°s saturando la API (Rate Limit).<br><br><span class='font-bold text-red-600'>üî¥ 5xx (Error Servidor - Culpa de ellos)</span><br>‚Ä¢ <strong>500 Internal Server Error:</strong> El c√≥digo del servidor fall√≥.<br>‚Ä¢ <strong>503 Service Unavailable:</strong> Servidor ca√≠do o en mantenimiento.",
                            analogy: "üì® <strong>Analog√≠a Postal:</strong><br>‚Ä¢ <strong>URL:</strong> La direcci√≥n de la casa.<br>‚Ä¢ <strong>Verbo:</strong> Lo que quieres hacer (Entregar paquete, Recoger carta).<br>‚Ä¢ <strong>Headers:</strong> Las estampillas y etiquetas ('Fragil', 'Prioritario').<br>‚Ä¢ <strong>Auth (Token):</strong> Tu carnet de empleado postal que te deja entrar al edificio.<br>‚Ä¢ <strong>Body:</strong> El contenido de la caja (solo en POST/PUT).<br>‚Ä¢ <strong>Status Code:</strong> El acuse de recibo ('Entregado', 'Direcci√≥n no existe').",
                            warning: "‚ö†Ô∏è <strong>Seguridad:</strong> Nunca env√≠es contrase√±as o tokens (API Keys) en la URL (Query Params), ya que quedan guardados en el historial del navegador/proxy. √ösalo siempre en los <strong>Headers</strong> o en el <strong>Body</strong> (POST)."
                        },
                        comparison: [
                            {
                                title: "GET (Leer) üîç",
                                pros: ["Simple y r√°pido", "Cacheable por el navegador", "Se puede guardar en favoritos"],
                                cons: ["No seguro para datos sensibles", "L√≠mite de longitud en URL", "Solo env√≠a texto"],
                                bestFor: "Consultas de datos, B√∫squedas, Filtros"
                            },
                            {
                                title: "POST (Escribir) üìù",
                                pros: ["Seguro (datos en el cuerpo)", "Sin l√≠mite de tama√±o", "Soporta binarios (archivos, im√°genes)"],
                                cons: ["No cacheable por defecto", "M√°s complejo de construir manualmente"],
                                bestFor: "Login, Subir archivos, Enviar formularios, Inferencia de modelos"
                            }
                        ],
                        code: {
                            title: "Cliente API Robusto (OOP + Session)",
                            language: "python",
                            snippet: `import requests
from typing import Optional, Dict, Any

class APIClient:
    """
    Cliente profesional para interactuar con APIs.
    Encapsula la configuraci√≥n (URL, Claves) para no repetirla.
    """
    
    def __init__(self, base_url: str, api_key: str):
        """
        El CONSTRUCTOR: Se ejecuta autom√°ticamente al crear la clase.
        Aqu√≠ configuramos lo que el robot necesita 'recordar': la URL y la Llave.
        """
        self.base_url = base_url
        
        # Session: Un 'T√∫nel Permanente' (Conexi√≥n TCP) con el servidor.
        # Mejora el rendimiento al no tener que reconectar en cada petici√≥n.
        self.session = requests.Session()
        
        # Headers Globales: Se enviar√°n en TODAS las peticiones de esta sesi√≥n.
        # As√≠ no tenemos que escribir 'Authorization' en cada funci√≥n.
        self.session.headers.update({
            "Authorization": f"Bearer {api_key}",
            "Content-Type": "application/json",
            "User-Agent": "MiAppDataScience/1.0"
        })

    def get_data(self, endpoint: str, params: Optional[Dict] = None) -> Dict:
        """
        M√©todo para LEER datos (Verbo HTTP: GET).
        :param endpoint: La parte final de la URL (ej: 'usuarios/1')
        :param params: Filtros opcionales (ej: {'page': 2})
        """
        try:
            url = f"{self.base_url}/{endpoint}"
            # Usamos self.session.get en lugar de requests.get
            response = self.session.get(url, params=params, timeout=10)
            
            # ¬°IMPORTANTE! Valida si el c√≥digo es 200 OK.
            # Si es 4xx o 5xx, lanza una excepci√≥n (salta al 'except').
            response.raise_for_status() 
            
            return response.json() # Convierte el texto JSON a Diccionario Python
            
        except requests.exceptions.HTTPError as err:
            # Manejo de errores espec√≠ficos seg√∫n el c√≥digo de estado
            if response.status_code == 401:
                print("‚õî Error: Credenciales inv√°lidas (Token vencido o incorrecto).")
            elif response.status_code == 429:
                print("‚è≥ Error: Rate Limit. Est√°s haciendo muchas peticiones muy r√°pido.")
            else:
                print(f"‚ùå Error HTTP Gen√©rico: {err}")
            return {}
            
        except Exception as e:
            print(f"üî• Error cr√≠tico (Red, Timeout, etc): {e}")
            return {}

    def predict(self, features: Dict[str, Any]) -> float:
        """
        M√©todo para ENVIAR datos y recibir predicci√≥n (Verbo HTTP: POST).
        :param features: Diccionario con los datos del modelo (ej: {'edad': 30})
        """
        try:
            url = f"{self.base_url}/predict"
            # 'json=features' convierte autom√°ticamente el dict a JSON v√°lido
            response = self.session.post(url, json=features, timeout=5)
            response.raise_for_status()
            
            # Asumimos que la API devuelve algo como: {"prediction": 4500.50}
            return response.json().get('prediction', 0.0)
            
        except Exception as e:
            print(f"‚ùå Error en predicci√≥n: {e}")
            return 0.0

# --- EJEMPLO DE USO ---

# 1. Instanciar la clase (Crear el objeto 'cliente')
# Aqu√≠ se ejecuta el __init__
cliente = APIClient(base_url="https://api.empresa.com/v1", api_key="sk_live_123")

# 2. Consultar estado (Usa el m√©todo GET)
print("üì° Consultando estado del sistema...")
status = cliente.get_data("system/status")
print(f"‚úÖ Estado: {status.get('status', 'Desconocido')}")

# 3. Realizar predicci√≥n (Usa el m√©todo POST)
print("\\nü§ñ Solicitando predicci√≥n...")
input_data = {"kms": 50000, "a√±o": 2020, "marca": "Toyota"}
precio = cliente.predict(input_data)
print(f"üí∞ Precio estimado: \${precio:,.2f}")`,
                            output: "‚úÖ Estado del sistema: ONLINE\nüí∞ Precio estimado: $45,200.00"
                        },
                        codeExplanation: {
                            title: "üîç Desglosando el C√≥digo",
                            steps: [
                                {
                                    title: "1. Inicializaci√≥n (__init__)",
                                    text: "Creamos una <strong>Session</strong>. Esto es como abrir un t√∫nel permanente con el servidor. En lugar de abrir y cerrar conexi√≥n por cada petici√≥n (lento), la mantenemos abierta y reutilizamos los headers (Auth, Content-Type) para no repetirlos."
                                },
                                {
                                    title: "2. M√©todo get_data()",
                                    text: "Encapsula la l√≥gica de lectura. Usa <code>response.raise_for_status()</code> para que si la API falla (ej: 404, 500), el c√≥digo se detenga y nos avise, en lugar de intentar procesar datos corruptos. Tambi√©n maneja errores espec√≠ficos como <strong>401 (Auth)</strong> o <strong>429 (Rate Limit)</strong>."
                                },
                                {
                                    title: "3. M√©todo predict()",
                                    text: "Env√≠a datos con <strong>POST</strong>. La librer√≠a <code>requests</code> convierte autom√°ticamente el diccionario de Python a JSON gracias al par√°metro <code>json=features</code>."
                                }
                            ]
                        },
                        quizzes: [
                            {
                                question: "1. Est√°s dise√±ando una API para que usuarios suban sus Hoja de Vida (PDF). ¬øQu√© m√©todo HTTP usas?",
                                options: [
                                    "GET, porque es m√°s r√°pido.",
                                    "POST, porque env√≠as un archivo (body) al servidor.",
                                    "DELETE, para borrar el desempleo.",
                                    "PUT, para actualizar la base de datos."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Correcto. POST es el est√°ndar para enviar datos complejos o archivos. GET no soporta cuerpo de mensaje."
                            },
                            {
                                question: "2. Si al consultar la API recibes un error 401 Unauthorized, ¬øqu√© significa?",
                                options: [
                                    "La API est√° ca√≠da (Server Error).",
                                    "Hiciste demasiadas peticiones (Rate Limit).",
                                    "Te faltan las credenciales (API Key/Token) o son inv√°lidas.",
                                    "Borraste un dato sin querer."
                                ],
                                correct: 2,
                                feedback: "‚úÖ Correcto. 401 significa 'No te conozco'. Debes revisar tus Headers de autenticaci√≥n."
                            },
                            {
                                question: "3. ¬øPor qu√© usamos `requests.Session()` en lugar de `requests.get()` directo?",
                                options: [
                                    "Para hacer el c√≥digo m√°s corto.",
                                    "Para reutilizar la conexi√≥n TCP (Handshake) y mejorar el rendimiento.",
                                    "Porque `requests.get` est√° obsoleto.",
                                    "Para encriptar los datos."
                                ],
                                correct: 1,
                                feedback: "‚úÖ ¬°Exacto! Abrir una conexi√≥n nueva cuesta tiempo (Handshake SSL, TCP). 'Session' mantiene el t√∫nel abierto."
                            }
                        ],
                        glossary: {
                            title: "üêç Glosario Python: Clases y M√©todos",
                            items: [
                                {
                                    term: "def",
                                    definition: "Palabra clave para definir una funci√≥n (o m√©todo si est√° dentro de una clase)."
                                },
                                {
                                    term: "__init__",
                                    definition: "El <strong>Constructor</strong>. Es un m√©todo especial que se ejecuta <em>autom√°ticamente</em> al crear una nueva instancia de la clase. Se usa para inicializar variables (como <code>self.api_key</code>) y configurar el objeto antes de usarlo."
                                },
                                {
                                    term: "class",
                                    definition: "La <strong>Plantilla</strong> (Blueprint). Define la estructura y el comportamiento de los objetos. Es como el plano de una casa; los objetos son las casas construidas a partir de ese plano."
                                },
                                {
                                    term: "Conexi√≥n TCP",
                                    definition: "El <strong>T√∫nel</strong> de comunicaci√≥n. Es el canal estable por donde viajan los datos. Abrir este t√∫nel es costoso (lento), por eso usamos <code>Session</code> para mantenerlo abierto y reutilizarlo."
                                }
                            ],
                            conceptualExample: {
                                title: "¬øPor qu√© usar Clases? (Vs C√≥digo Espagueti)",
                                description: "Las clases nos permiten <strong>encapsular</strong> datos y l√≥gica, evitando el desorden de variables globales.",
                                codeOld: `# ‚ùå SIN CLASES (Dif√≠cil de mantener)
url1 = "api.com"
key1 = "123"

def get_data(u, k):
    pass # l√≥gica...

get_data(url1, key1) # Hay que pasar todo siempre`,
                                codeNew: `# ‚úÖ CON CLASES (Limpio y Reusable)
cliente = APIClient("api.com", "123")
cliente.get_data() # ¬°Ya sabe su URL y Key!`
                            }
                        }
                    }
                },
                {
                    id: "m2",
                    title: "M√≥dulo 2: JSON vs Pickle",
                    shortTitle: "Formatos",
                    objective: "Elegir el formato de serializaci√≥n adecuado seg√∫n el caso de uso (interoperabilidad vs especificidad).",
                    duration: "30 min",
                    content: {
                        concept: {
                            title: "Serializaci√≥n: Congelando Objetos",
                            text: "Para guardar un objeto de Python (un diccionario, un modelo entrenado) en un archivo o enviarlo por red, debemos <span class='tooltip'>Serializarlo<span class='tooltip-text'>Convertir un objeto en memoria a una secuencia de bytes o texto para guardarlo o transmitirlo.</span></span>. El proceso inverso es la <span class='tooltip'>Deserializaci√≥n<span class='tooltip-text'>Reconstruir el objeto original en memoria a partir de los bytes o texto guardados.</span></span>.<br><br><strong>1. JSON (El Est√°ndar Web):</strong><br>Es texto plano, legible por humanos y compatible con casi todos los lenguajes (Python, JS, Java).<br>‚ùå <em>Limitaci√≥n:</em> Solo entiende tipos simples (texto, n√∫meros, listas, booleanos). <strong>NO</strong> soporta fechas (`datetime`), tuplas o clases personalizadas directamente.<br><br><strong>2. Pickle (La Magia de Python):</strong><br>Es un formato binario (no legible por humanos) espec√≠fico de Python.<br>‚úÖ <em>Ventaja:</em> Puede guardar casi <strong>CUALQUIER</strong> objeto de Python: funciones, clases, modelos de Machine Learning (Scikit-Learn), DataFrames de Pandas, etc.<br>‚ùå <em>Peligro:</em> <strong>Nunca</strong> cargues un archivo `.pkl` de internet. Al deserializarlo, puede ejecutar c√≥digo malicioso en tu PC.",
                            analogy: "üì¶ <strong>Analog√≠a del Env√≠o:</strong><br>‚Ä¢ <strong>JSON:</strong> Es una carta escrita en ingl√©s. Cualquiera puede leerla, pero no puedes enviar cosas f√≠sicas, solo descripciones.<br>‚Ä¢ <strong>Pickle:</strong> Es un teletransportador de ciencia ficci√≥n. Desintegra el objeto (√°tomo por √°tomo) y lo reconstruye id√©ntico al otro lado. Pero si te env√≠an una bomba teletransportada, explotar√° al reconstruirse.",
                            warning: "‚ö†Ô∏è <strong>Seguridad Cr√≠tica:</strong> `pickle.load()` es inseguro por dise√±o. Solo √∫salo con archivos que T√ö mismo creaste o en los que conf√≠as plenamente."
                        },
                        comparison: [
                            {
                                title: "JSON üìÑ",
                                pros: ["Legible por humanos (Texto)", "Universal (Interoperable)", "Seguro (Solo datos)"],
                                cons: ["Pierde tipos complejos (Tuplas -> Listas, Fechas -> Strings)", "M√°s lento con grandes vol√∫menes num√©ricos"],
                                bestFor: "APIs REST, Configuraci√≥n, Compartir datos entre lenguajes"
                            },
                            {
                                title: "Pickle ü•í",
                                pros: ["Guarda TODO (Funciones, Clases, Modelos)", "Mantiene tipos exactos", "Binario (Eficiente para objetos Python)"],
                                cons: ["Solo Python (No sirve para Java/JS)", "Inseguro (Ejecuci√≥n de c√≥digo arbitrario)", "Fr√°gil entre versiones de librer√≠as"],
                                bestFor: "Persistencia de Modelos ML, Pausar/Reanudar procesos, Cach√© local"
                            }
                        ],
                        code: {
                            title: "El Problema de las Fechas (Type Loss)",
                            language: "python",
                            snippet: `import json
import pickle
from datetime import datetime

# Datos con tipos complejos (Fecha)
data = {
    "evento": "Clase de Python",
    "fecha": datetime.now(), # <--- Objeto complejo
    "asistentes": ("Juan", "Maria") # <--- Tupla
}

print(f"üêç Original: {type(data['fecha'])} - {type(data['asistentes'])}")

# --- INTENTO 1: JSON ---
try:
    # json.dumps(data) # ‚ùå Error: Object of type datetime is not JSON serializable
    
    # Soluci√≥n: Convertir a String manualmente
    data_json = data.copy()
    data_json['fecha'] = str(data['fecha']) 
    
    texto_json = json.dumps(data_json)
    print(f"üìÑ JSON: {texto_json}")
    
    # Al recuperar... ¬°perdimos los tipos!
    recuperado = json.loads(texto_json)
    print(f"üíî Recuperado: {type(recuperado['fecha'])} (Ahora es str) y {type(recuperado['asistentes'])} (Ahora es list)")
except Exception as e:
    print(e)

# --- INTENTO 2: PICKLE ---
# Pickle guarda el objeto TAL CUAL (Binario)
bytes_pickle = pickle.dumps(data)
print(f"ü•í Pickle (Bytes): {bytes_pickle[:20]}...")

recuperado_pkl = pickle.loads(bytes_pickle)
print(f"‚ú® Restaurado: {type(recuperado_pkl['fecha'])} y {type(recuperado_pkl['asistentes'])}")
print("¬°Conserv√≥ la Fecha y la Tupla exactas!")`,
                            output: "üêç Original: <class 'datetime.datetime'> - <class 'tuple'>\nüìÑ JSON: {\"evento\": \"Clase de Python\", \"fecha\": \"2023-10-27...\", \"asistentes\": [\"Juan\", \"Maria\"]}\nüíî Recuperado: <class 'str'> (Ahora es str) y <class 'list'> (Ahora es list)\nü•í Pickle (Bytes): b'\\x80\\x04\\x95\\x8e\\x00\\x00\\x00\\x00\\x00\\x00\\x00}...' \n‚ú® Restaurado: <class 'datetime.datetime'> y <class 'tuple'>\n¬°Conserv√≥ la Fecha y la Tupla exactas!"
                        },
                        codeExplanation: {
                            title: "üîç An√°lisis del C√≥digo",
                            steps: [
                                {
                                    title: "1. Tipos Complejos",
                                    text: "En Python usamos `datetime` para fechas y `tuple` para listas inmutables. Estos son objetos ricos con m√©todos propios."
                                },
                                {
                                    title: "2. La Limitaci√≥n de JSON",
                                    text: "JSON es un formato de texto simple. No sabe qu√© es una fecha. Para guardar, tuvimos que convertirla a texto (`str`). Al cargar, vuelve como texto, perdiendo su 'magia' (ya no puedes hacer `.year` o `.month` sin reconvertir)."
                                },
                                {
                                    title: "3. La Fidelidad de Pickle",
                                    text: "Pickle toma la memoria y la guarda en bytes. Al cargar, restaura el objeto con su tipo original. Es perfecto para guardar el estado exacto de una aplicaci√≥n."
                                }
                            ]
                        },
                        quizzes: [
                            {
                                question: "1. Necesitas enviar datos desde tu backend Python a un frontend hecho en React (JavaScript). ¬øQu√© formato usas?",
                                options: [
                                    "Pickle, porque es m√°s r√°pido.",
                                    "JSON, porque es el est√°ndar web y JS lo entiende nativamente.",
                                    "CSV, para que lo abran en Excel.",
                                    "TXT, para que lo lean."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Correcto. JSON (JavaScript Object Notation) es nativo para JS y el est√°ndar de facto para APIs REST."
                            },
                            {
                                question: "2. Has entrenado un modelo de IA (Scikit-Learn) que tard√≥ 5 horas. Quieres guardarlo en disco para usarlo ma√±ana. ¬øQu√© usas?",
                                options: [
                                    "JSON, guarda los coeficientes manualmente.",
                                    "Pickle (o Joblib), porque guarda la estructura completa del objeto Python.",
                                    "Hacer una captura de pantalla.",
                                    "No se puede guardar."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Correcto. Los modelos son objetos complejos. Pickle los serializa conservando toda su estructura interna."
                            },
                            {
                                question: "3. Encuentras un archivo 'juego_pirata.pkl' en un foro. ¬øDeber√≠as cargarlo?",
                                options: [
                                    "S√≠, seguro tiene trucos gratis.",
                                    "No. Pickle puede ejecutar c√≥digo malicioso al abrirse.",
                                    "S√≠, si tengo antivirus.",
                                    "Solo si es peque√±o."
                                ],
                                correct: 1,
                                feedback: "‚úÖ ¬°Exacto! NUNCA abras Pickles de fuentes desconocidas. Es una vulnerabilidad de seguridad cr√≠tica (RCE)."
                            }
                        ],
                        glossary: {
                            title: "üóÇÔ∏è Glosario: Datos y Formatos",
                            items: [
                                {
                                    term: "Serializaci√≥n",
                                    definition: "El proceso de convertir un objeto en memoria (RAM) a un formato de almacenamiento (Disco/Red)."
                                },
                                {
                                    term: "JSON",
                                    definition: "<strong>J</strong>ava<strong>S</strong>cript <strong>O</strong>bject <strong>N</strong>otation. Formato de texto ligero para intercambio de datos."
                                },
                                {
                                    term: "Pickle",
                                    definition: "M√≥dulo de Python para serializaci√≥n de objetos. Convierte jerarqu√≠as de objetos Python en un flujo de bytes."
                                },
                                {
                                    term: "Byte Stream",
                                    definition: "Secuencia de bytes (0s y 1s). Es c√≥mo se ven los datos 'crudos' en la m√°quina. Pickle genera esto, no texto legible."
                                }
                            ]
                        }
                    }
                },
                {
                    id: "m3",
                    title: "M√≥dulo 3: Validaci√≥n con Pydantic",
                    shortTitle: "Pydantic",
                    objective: "Implementar validaci√≥n estricta de tipos para asegurar la calidad de los datos de entrada, usando Modelos, Field, Validadores y el patr√≥n de limpieza de DataFrames.",
                    duration: "40 min",
                    content: {
                        concept: {
                            title: "El Cadenero de tus Datos: De 'Garbage In' a Datos Confiables",
                            text: "En estad√≠stica existe un dicho famoso: <strong>'Garbage In, Garbage Out'</strong> (entra basura, sale basura). Si alimentas tu modelo con datos corruptos ‚Äî tipos incorrectos (texto 'veinte' donde va el n√∫mero 20), valores faltantes inesperados, o datos fuera de rango (una probabilidad de 1.5) ‚Äî tus conclusiones ser√°n err√≥neas sin importar qu√© tan sofisticado sea tu algoritmo.<br><br>Python es de tipado din√°mico, genial para prototipar pero peligroso en producci√≥n. En la era antigua llen√°bamos el c√≥digo de <code>if type(x) != int: raise Error</code>. Pydantic reemplaza esto por una <span class='tooltip'>Validaci√≥n Declarativa<span class='tooltip-text'>Defines QU√â quieres (el contrato), no C√ìMO validarlo paso a paso.</span></span>: describes QU√â forma deben tener tus datos y Pydantic se encarga del C√ìMO.<br><br>Pydantic act√∫a como el <strong>Cadenero (Bouncer)</strong> de tu script. T√∫ le das las reglas del club (el <span class='tooltip'>Esquema<span class='tooltip-text'>La estructura y tipos esperados de los datos.</span></span>) y √©l se encarga de revisar a todos en la entrada. Si alguien llega con 'zapatos equivocados', Pydantic intenta arreglarlos (<span class='tooltip'>Coerci√≥n<span class='tooltip-text'>Transformaci√≥n autom√°tica de datos, ej: recibir el texto '5' y convertirlo al n√∫mero 5.</span></span>). Pero a diferencia de otras librer√≠as, Pydantic no solo valida: intenta <em>parsear</em> (convertir) los datos al tipo correcto si es posible. Si no puede, los expulsa con un error detallado.<br><br><strong>Conceptos Clave del M√≥dulo:</strong><br>‚Ä¢ <strong>BaseModel:</strong> Al heredar de <code>BaseModel</code>, tu clase gana constructor autom√°tico (sin escribir <code>__init__</code>), serializaci√≥n (<code>.model_dump()</code>), y protecci√≥n de tipos en tiempo de ejecuci√≥n.<br>‚Ä¢ <strong>Field:</strong> Restricciones num√©ricas declarativas (<code>gt</code>, <code>le</code>, <code>ge</code>) y <code>description</code> para documentaci√≥n autom√°tica.<br>‚Ä¢ <strong>Campos Opcionales:</strong> <code>Optional[float] = None</code> permite manejar datos faltantes (<em>NaN</em>) expl√≠citamente ‚Äî vital en estad√≠stica para no sesgar promedios con ceros falsos.<br>‚Ä¢ <strong>@field_validator:</strong> Limpieza (<code>mode='before'</code>) para datos sucios (ej. coma decimal '12,5') y reglas de negocio (<code>mode='after'</code>) para l√≥gica que Pydantic no conoce.<br>‚Ä¢ <strong>Validaci√≥n de DataFrames:</strong> Patr√≥n fila-por-fila con <code>try/except</code> para separar registros buenos de err√≥neos sin detener el proceso.",
                            analogy: "üõ°Ô∏è <strong>Analog√≠a:</strong><br>‚Ä¢ <strong>Validaci√≥n Manual:</strong> Es como un guardia que tiene que revisar cada bolsillo manualmente y preguntar '¬øEres mayor de edad?'. Lento y propenso a errores.<br>‚Ä¢ <strong>Pydantic:</strong> Es un esc√°ner biom√©trico de aeropuerto. Pasas (los datos), y autom√°ticamente verifica identidad, pasaporte y equipaje en milisegundos. Si algo falla, te dice exactamente qu√© (ej: 'Pasaporte vencido').",
                            warning: "üí° <strong>Tip Moderno:</strong> Pydantic V2 est√° escrito en Rust, lo que lo hace extremadamente r√°pido. √ösalo para validar filas de DataFrames, respuestas de APIs o configuraciones complejas. Inst√°lalo con: <code>pip install pydantic</code>"
                        },
                        comparison: [
                            {
                                title: "Validaci√≥n Manual üöß",
                                pros: ["No requiere librer√≠as extra"],
                                cons: ["Verbosidad extrema (muchos `if/else`)", "Dif√≠cil de leer y mantener", "Reinventa la rueda en cada funci√≥n"],
                                bestFor: "Scripts diminutos sin dependencias"
                            },
                            {
                                title: "Pydantic üõ°Ô∏è",
                                pros: ["Declarativo (Legible)", "Coerci√≥n autom√°tica (Str -> Int)", "Mensajes de error estandarizados", "Serializaci√≥n (.model_dump())"],
                                cons: ["Requiere instalar librer√≠a", "Curva de aprendizaje inicial"],
                                bestFor: "APIs (FastAPI), Pipelines de Datos, Configuraci√≥n"
                            }
                        ],
                        code: {
                            title: "Contrato de Datos Completo: Field, Optional, Validadores y DataFrames",
                            language: "python",
                            snippet: `from pydantic import BaseModel, Field, field_validator, ValidationError
from typing import Optional, List
import pandas as pd

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# 1. MODELO CON FIELD, OPTIONAL Y VALIDADOR
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

class VariableEstadistica(BaseModel):
    # Campo obligatorio con restricci√≥n de longitud
    nombre: str = Field(..., min_length=2, description="Nombre de la variable")

    # Restricci√≥n num√©rica: gt = mayor que 0 (la desviaci√≥n no puede ser negativa)
    desviacion_std: float = Field(..., gt=0, description="Desviaci√≥n est√°ndar positiva")

    # Restricci√≥n de rango: ge=0, le=1 (probabilidad entre 0 y 1)
    probabilidad: float = Field(..., ge=0, le=1, description="Probabilidad [0,1]")

    # Campo NULLABLE (puede ser None) ‚Üí Dato faltante en estad√≠stica
    # Diferencia clave: None (no medido) vs 0 (medido con valor cero)
    n_muestras: Optional[int] = Field(default=None, ge=1)

    # Campo con valor por defecto
    activa: bool = True

    # VALIDADOR mode='before': Limpieza de datos sucios
    # Se ejecuta ANTES de verificar el tipo ‚Üí Ideal para arreglar formatos
    @field_validator('desviacion_std', mode='before')
    @classmethod
    def corregir_coma_decimal(cls, v):
        if isinstance(v, str):
            return float(v.replace(',', '.'))  # "2,5" ‚Üí 2.5
        return v

    # VALIDADOR mode='after': Regla de negocio (post-tipado)
    @field_validator('nombre')
    @classmethod
    def normalizar_nombre(cls, v: str) -> str:
        return v.strip().lower()  # "  Edad  " ‚Üí "edad"

# --- Prueba del Modelo ---
try:
    v1 = VariableEstadistica(
        nombre="  Peso  ", desviacion_std="12,5",  # Coma decimal (dato sucio)
        probabilidad=0.95, n_muestras=None          # Dato faltante expl√≠cito
    )
    print(f"‚úÖ Modelo: {v1}")
    print(f"üì¶ Dict:  {v1.model_dump()}")
except ValidationError as e:
    print(f"‚ùå ERROR: {e}")

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# 2. VALIDACI√ìN DE DATAFRAME (PANDAS)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

class Transaccion(BaseModel):
    id_tx: int
    monto: float = Field(gt=0)
    categoria: str

df = pd.DataFrame([
    {"id_tx": 1,   "monto": 100.50, "categoria": "comida"},     # ‚úÖ OK
    {"id_tx": "2", "monto": 200,    "categoria": "transporte"}, # ‚úÖ Coerci√≥n str‚Üíint
    {"id_tx": 3,   "monto": "abc",  "categoria": "ocio"},       # ‚ùå Monto inv√°lido
])

limpios, errores = [], []
for i, fila in df.iterrows():
    try:
        dato = Transaccion(**fila.to_dict())
        limpios.append(dato.model_dump())
    except ValidationError as e:
        errores.append({"fila": i, "error": str(e)})

print(f"\\nüìä V√°lidos: {len(limpios)} | Fallidos: {len(errores)}")
df_final = pd.DataFrame(limpios)
print(df_final)`,
                            output: "‚úÖ Modelo: nombre='peso' desviacion_std=12.5 probabilidad=0.95 n_muestras=None activa=True\\nüì¶ Dict: {'nombre': 'peso', 'desviacion_std': 12.5, 'probabilidad': 0.95, 'n_muestras': None, 'activa': True}\\n\\nüìä V√°lidos: 2 | Fallidos: 1\\n   id_tx   monto   categoria\\n0      1  100.50      comida\\n1      2  200.00  transporte"
                        },
                        codeExplanation: {
                            title: "üîç An√°lisis del Modelo Completo",
                            steps: [
                                {
                                    title: "1. BaseModel (El N√∫cleo)",
                                    text: "Al heredar de <code>BaseModel</code>, la clase <code>VariableEstadistica</code> gana superpoderes autom√°ticos: constructor sin escribir <code>__init__</code>, serializaci√≥n con <code>.model_dump()</code> (ideal para exportar a dicts/JSON/Pandas), y protecci√≥n de tipos en tiempo de ejecuci√≥n."
                                },
                                {
                                    title: "2. Field (Restricciones Declarativas)",
                                    text: "Usamos <code>Field(gt=0)</code> para 'mayor que 0', <code>Field(ge=0, le=1)</code> para 'entre 0 y 1', y <code>description</code> para documentar qu√© significa cada variable. Cuando usas <code>Field(...)</code> (tres puntos), el campo es <strong>requerido</strong>. Esto reemplaza docenas de l√≠neas de <code>if/else</code>."
                                },
                                {
                                    title: "3. Campos Opcionales y Nulos",
                                    text: "<code>Optional[int] = None</code> permite que un valor sea nulo expl√≠citamente (<em>dato faltante</em>). <strong>Nota estad√≠stica:</strong> diferenciar entre <code>0</code> (valor observado) y <code>None</code> (dato perdido) es vital para no sesgar promedios. Si un paciente no reporta cu√°ntos cigarrillos fuma y ponemos 0, bajamos el promedio falsamente."
                                },
                                {
                                    title: "4. Validadores @field_validator",
                                    text: "<strong>mode='before':</strong> Limpieza de datos sucios. Se ejecuta ANTES de la validaci√≥n de tipo, ideal para corregir formatos (coma decimal '12,5' ‚Üí 12.5). <strong>mode='after':</strong> Reglas post-tipado como normalizar texto a min√∫sculas. Ambos usan <code>@classmethod</code> porque no necesitan instancia creada."
                                },
                                {
                                    title: "5. Patr√≥n de Validaci√≥n de DataFrames",
                                    text: "La integraci√≥n con Pandas usa un bucle <code>for fila in df.iterrows()</code> con <code>try/except</code>. Cada fila se valida individualmente: las buenas van a <code>limpios</code>, las malas a <code>errores</code> con detalle de qu√© fall√≥. As√≠ no se detiene el pipeline por una fila corrupta."
                                }
                            ]
                        },
                        quizzes: [
                            {
                                question: "1. Si env√≠as el string '50' a un campo definido como `edad: int`, ¬øQu√© hace Pydantic por defecto?",
                                options: [
                                    "Lanza un error de tipo (TypeError).",
                                    "Lo convierte autom√°ticamente al entero 50 (Coerci√≥n).",
                                    "Lo deja como string '50'.",
                                    "Borra el dato."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Correcto. Pydantic intenta 'coaccionar' (convertir) los tipos. Como '50' es un string num√©rico v√°lido, lo transforma autom√°ticamente a entero."
                            },
                            {
                                question: "2. ¬øPara qu√© sirve `Field(gt=0, le=1, description='...')` en la definici√≥n del modelo?",
                                options: [
                                    "Para definir un valor por defecto de 0.",
                                    "Para decir que el campo es opcional.",
                                    "Para imponer restricciones num√©ricas (rango) y a√±adir documentaci√≥n al campo.",
                                    "No hace nada, es comentario."
                                ],
                                correct: 2,
                                feedback: "‚úÖ Exacto. Field combina restricciones de validaci√≥n (gt, le, ge, min_length) con documentaci√≥n (description), todo de forma declarativa."
                            },
                            {
                                question: "3. ¬øPor qu√© preferimos Pydantic sobre escribir muchos `if/else`?",
                                options: [
                                    "Porque Pydantic es de Google.",
                                    "Porque hace el c√≥digo m√°s legible, seguro y estandariza los mensajes de error.",
                                    "Porque Python obliga a usarlo.",
                                    "Para hacer el c√≥digo m√°s lento."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Correcto. La legibilidad y la estandarizaci√≥n son claves. Adem√°s, Pydantic genera documentaci√≥n autom√°tica (OpenAPI) en frameworks como FastAPI."
                            },
                            {
                                question: "4. En estad√≠stica, ¬øpor qu√© preferimos `int | None = None` sobre `int = 0` para datos faltantes?",
                                options: [
                                    "Porque None ocupa menos memoria.",
                                    "Porque 0 es un valor num√©rico real y puede sesgar el promedio si el dato en realidad faltaba.",
                                    "Porque Python prefiere None.",
                                    "No hay diferencia."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Crucial. Si un paciente no responde cu√°ntos cigarrillos fuma y ponemos 0, bajamos el promedio falsamente. Con None, podemos excluirlo del c√°lculo."
                            },
                            {
                                question: "5. ¬øCu√°l es la utilidad de `@field_validator(..., mode='before')`?",
                                options: [
                                    "Validar datos despu√©s de crearlos.",
                                    "Limpiar o transformar datos crudos antes de que Pydantic verifique su tipo.",
                                    "Hacer que la validaci√≥n sea m√°s r√°pida.",
                                    "Ignorar los errores de validaci√≥n."
                                ],
                                correct: 1,
                                feedback: "‚úÖ Correcto. Es ideal para 'Data Cleaning': convertir formatos extra√±os (ej. coma decimal '1,5') a tipos nativos antes de que Pydantic lance un error."
                            },
                            {
                                question: "6. ¬øCu√°l es la mejor estrategia para validar un DataFrame de Pandas con Pydantic?",
                                options: [
                                    "Convertir todo el DataFrame a un solo objeto Pydantic.",
                                    "No se puede usar Pydantic con Pandas.",
                                    "Iterar sobre las filas, validar cada una con try/except y separar v√°lidos de errores.",
                                    "Usar Pandas para validar tipos."
                                ],
                                correct: 2,
                                feedback: "‚úÖ Exacto. Iterar permite capturar errores fila por fila sin detener todo el proceso, creando un pipeline de datos robusto."
                            }
                        ],
                        glossary: {
                            title: "üóÇÔ∏è Glosario: Validaci√≥n con Pydantic",
                            items: [
                                {
                                    term: "Esquema (Schema)",
                                    definition: "La definici√≥n formal de la estructura de tus datos. Qu√© campos existen y qu√© tipos tienen."
                                },
                                {
                                    term: "BaseModel",
                                    definition: "Clase base de Pydantic. Al heredar de ella, tu clase gana constructor autom√°tico, serializaci√≥n (<code>.model_dump()</code>), y validaci√≥n de tipos sin escribir c√≥digo extra."
                                },
                                {
                                    term: "Type Hinting",
                                    definition: "Sintaxis de Python (<code>x: int</code>) para indicar el tipo de dato esperado. Pydantic usa esto para saber c√≥mo validar."
                                },
                                {
                                    term: "Coerci√≥n",
                                    definition: "La conversi√≥n autom√°tica y forzada de un tipo de dato a otro (ej. String -> Integer) para cumplir con el esquema."
                                },
                                {
                                    term: "Field",
                                    definition: "Funci√≥n de Pydantic para a√±adir restricciones (<code>gt</code>, <code>le</code>, <code>min_length</code>) y metadatos (<code>description</code>) a cada campo de un modelo."
                                },
                                {
                                    term: "Optional / Nullable",
                                    definition: "<code>Optional[float] = None</code> o <code>float | None = None</code>. Permite que un campo sea expl√≠citamente nulo, crucial para representar datos faltantes en estad√≠stica."
                                },
                                {
                                    term: "@field_validator",
                                    definition: "Decorador para l√≥gica personalizada. <code>mode='before'</code> limpia datos antes de la validaci√≥n de tipo; <code>mode='after'</code> aplica reglas de negocio post-tipado."
                                },
                                {
                                    term: "Declarativo",
                                    definition: "Estilo de programaci√≥n donde describes QU√â quieres lograr (ej. 'edad > 18') en lugar de C√ìMO hacerlo paso a paso."
                                }
                            ]
                        }
                    }
                },
                {
                    id: "m4",
                    title: "M√≥dulo 4: requirements.txt",
                    shortTitle: "Dependencias",
                    objective: "Garantizar la reproducibilidad del entorno de an√°lisis en cualquier m√°quina.",
                    duration: "20 min",
                    content: {
                        concept: {
                            title: "La Receta Exacta y la Cocina Aislada",
                            text: "Tu c√≥digo no vive en el vac√≠o; vive sobre una monta√±a de librer√≠as (pandas, numpy, scikit-learn). Pero... ¬øQu√© pasa si el Proyecto A necesita `pandas 1.0` y el Proyecto B necesita `pandas 2.0`? Si instalas todo globalmente, tendr√°s un conflicto (<span class='tooltip'>Dependency Hell<span class='tooltip-text'>Situaci√≥n donde paquetes incompatibles rompen tu entorno.</span></span>).<br><br>Para evitar esto, usamos <span class='tooltip'>Entornos Virtuales (venv)<span class='tooltip-text'>Una carpeta aislada que contiene su propia copia de Python y librer√≠as para un proyecto espec√≠fico.</span></span>.",
                            analogy: "üç∞ <strong>Analog√≠a:</strong><br>‚Ä¢ <strong>Global:</strong> Una sola cocina comunitaria donde todos cocinan a la vez. Si alguien tira sal al pur√©, ¬°arruina el pastel de al lado!<br>‚Ä¢ <strong>Entorno Virtual:</strong> Cada chef tiene su propia cocina privada y cerrada. Lo que pasa en la cocina A, se queda en la cocina A.",
                            warning: "‚ö†Ô∏è <strong>Pr√°ctica Vital:</strong> Nunca uses `pip install` en tu sistema global. Crea siempre un entorno virtual (`python -m venv .venv`) antes de empezar."
                        },
                        comparison: [
                            {
                                title: "Instalaci√≥n Global üåç",
                                pros: ["F√°cil al principio (solo `pip install`)"],
                                cons: ["Conflictos de versiones entre proyectos", "Rompe el sistema operativo", "Irreproducible"],
                                bestFor: "Nada (Evitar siempre)"
                            },
                            {
                                title: "Entorno Virtual üì¶",
                                pros: ["Aislamiento total", "Reproducible (requirements.txt)", "Seguro"],
                                cons: ["Requiere pasos extra (activar)"],
                                bestFor: "Todos los proyectos de Python"
                            }
                        ],
                        code: {
                            title: "Flujo de Trabajo Profesional",
                            language: "bash",
                            snippet: `# 1. CREAR el entorno virtual (solo una vez)
# (Esto crea una carpeta .venv oculta)
python -m venv .venv

# 2. ACTIVAR el entorno (Cada vez que trabajes)
# Mac/Linux:
source .venv/bin/activate
# Windows:
# .\\.venv\\Scripts\\activate

# (Ver√°s que tu terminal cambia: "(.venv) user@mac:~$")

# 3. INSTALAR librer√≠as (Se guardan en .venv, no en el sistema)
pip install pandas==2.0.3 numpy scikit-learn

# 4. CONGELAR versiones para compartir
pip freeze > requirements.txt

# --- Contenido generado en requirements.txt ---
# numpy==1.24.3
# pandas==2.0.3
# ...`,
                            output: "(.venv) $ pip freeze > requirements.txt\n(Se crea el archivo con las versiones exactas)"
                        },
                        codeExplanation: {
                            title: "üîç El Ciclo de Vida",
                            steps: [
                                {
                                    title: "1. python -m venv .venv",
                                    text: "El comando m√°gico. Crea una carpeta `.venv` que es una copia ligera de Python. Todo lo que hagas ahora ocurrir√° all√≠ adentro."
                                },
                                {
                                    title: "2. Activar",
                                    text: "Le dice a tu terminal: 'Oye, cuando diga python o pip, usa los de la carpeta .venv, no los de Windows/Mac'."
                                },
                                {
                                    title: "3. pip freeze",
                                    text: "Toma una foto instant√°nea de todas las librer√≠as instaladas y sus versiones exactas. Es la garant√≠a de que a tu colega le funcionar√° igual."
                                }
                            ]
                        },
                        quizzes: [
                            {
                                question: "¬øPor qu√© es importante el s√≠mbolo '==' en requirements.txt (ej: pandas==2.0.1)?",
                                options: [
                                    "Es solo sintaxis, no importa.",
                                    "Para indicar que instale la versi√≥n m√°s reciente.",
                                    "Para 'anclar' (pin) la versi√≥n exacta y asegurar que el c√≥digo funcione igual en el futuro.",
                                    "Para comparar si pandas est√° instalado."
                                ],
                                correct: 2,
                                feedback: "‚úÖ Correcto. 'Pinning' (anclar) versiones previene que una actualizaci√≥n futura de una librer√≠a rompa tu an√°lisis estad√≠stico antiguo."
                            }
                        ],
                        glossary: {
                            title: "üóÇÔ∏è Glosario: Entornos",
                            items: [
                                {
                                    term: "Virtual Environment",
                                    definition: "Espacio aislado para dependencias de un proyecto. Evita conflictos 'Dependency Hell'."
                                },
                                {
                                    term: "pip freeze",
                                    definition: "Comando que lista todas las librer√≠as instaladas y sus versiones. Se usa para generar `requirements.txt`."
                                },
                                {
                                    term: "requirements.txt",
                                    definition: "Archivo de texto que define las dependencias exactas de un proyecto. Permite reproducir el entorno con `pip install -r requirements.txt`."
                                }
                            ]
                        }
                    }
                },
                {
                    id: "m7",
                    title: "M√≥dulo 5 (Bonus): Funciones en Python",
                    shortTitle: "Funciones",
                    objective: "Aprender a encapsular l√≥gica y reutilizar c√≥digo mediante funciones.",
                    duration: "25 min",
                    content: {
                        concept: {
                            title: "El Poder de las Funciones",
                            text: "Una funci√≥n es un bloque de c√≥digo reutilizable que realiza una tarea espec√≠fica. En lugar de copiar y pegar el mismo c√≥digo (lo cual es propenso a errores), definimos una funci√≥n y la llamamos cuando la necesitamos. Esto sigue el principio DRY: <strong>Don't Repeat Yourself</strong>.<br><br><strong>Estructura:</strong><br>‚Ä¢ <code>def</code>: La palabra clave para definirla.<br>‚Ä¢ <strong>Nombre:</strong> Descriptivo y en <code>snake_case</code>.<br>‚Ä¢ <strong>Argumentos:</strong> Los 'ingredientes' que recibe entre par√©ntesis.<br>‚Ä¢ <strong>Cuerpo:</strong> El c√≥digo indentado que ejecuta.<br>‚Ä¢ <code>return</code>: El valor que 'devuelve' al final.",
                            analogy: "üç≥ <strong>La Receta de Cocina:</strong><br>Imagina una funci√≥n como una m√°quina de hacer pasta.<br>‚Ä¢ <strong>Input (Argumentos):</strong> Harina y huevos.<br>‚Ä¢ <strong>Proceso (Cuerpo):</strong> Mezclar, amasar, cortar.<br>‚Ä¢ <strong>Output (Return):</strong> Fettuccine fresco.<br>T√∫ no necesitas saber c√≥mo funciona la m√°quina por dentro cada vez que la usas; solo le das los ingredientes y obtienes el resultado.",
                            warning: "‚ö†Ô∏è <strong>Scope (Alcance):</strong> Las variables creadas <em>dentro</em> de una funci√≥n son locales; no existen fuera de ella. ¬°Es como lo que pasa en Las Vegas!"
                        },
                        comparison: [
                            {
                                title: "Copy-Paste üìã",
                                pros: ["R√°pido para una vez"],
                                cons: ["C√≥digo duplicado", "Dif√≠cil de mantener", "Errores se multiplican"],
                                bestFor: "Nunca en producci√≥n"
                            },
                            {
                                title: "Funciones üõ†Ô∏è",
                                pros: ["Reutilizable", "Legible", "F√°cil de testear"],
                                cons: ["Requiere pensar la abstracci√≥n"],
                                bestFor: "Todo bloque de l√≥gica repetida"
                            }
                        ],
                        code: {
                            title: "Tu Primera Funci√≥n",
                            language: "python",
                            snippet: `def agregar_tres(input_var):
    """
    Suma 3 al numero entregado.
    """
    output_var = input_var + 3
    return output_var

# Probando la funcion
nuevo_numero = agregar_tres(10)
print(f"El resultado es: {nuevo_numero}")`,
                            output: "El resultado es: 13"
                        },
                        codeExplanation: {
                            title: "Desglosando la Funci√≥n",
                            steps: [
                                { title: "Header", text: "Comienza con `def`, el nombre y los argumentos." },
                                { title: "Docstring", text: "Texto entre comillas triples que explica qu√© hace la funci√≥n. ¬°Documentaci√≥n es amor!" },
                                { title: "Cuerpo", text: "El bloque de c√≥digo indentado que hace el trabajo." },
                                { title: "Return", text: "La sentencia que env√≠a el resultado de vuelta al programa principal." }
                            ]
                        },
                        quizzes: [
                            {
                                question: "¬øQu√© palabra clave comienza la definici√≥n de una funci√≥n?",
                                options: ["function", "def", "func", "define"],
                                correct: 1,
                                feedback: "‚úÖ ¬°Exacto! En Python usamos `def` para definir funciones."
                            }
                        ]
                    }
                },
                {
                    id: "synth",
                    title: "S√≠ntesis e Integraci√≥n",
                    shortTitle: "Resumen",
                    objective: "Integrar los conceptos en un pipeline mental robusto.",
                    duration: "15 min",
                    content: {
                        concept: {
                            title: "Pipeline Completo: De Idea a An√°lisis Reproducible",
                            text: "<strong>Resumen del flujo de trabajo profesional:</strong><br><br><strong>1. Configuraci√≥n del Entorno (una vez por proyecto)</strong><br>‚Ä¢ Crear repositorio Git: <code>git init</code><br>‚Ä¢ Crear entorno virtual: <code>python -m venv env</code> o <code>conda create</code><br>‚Ä¢ Definir <code>.gitignore</code> (datos, outputs, env)<br>‚Ä¢ Primer commit: <code>git add . && git commit -m 'Estructura inicial'</code><br>‚Ä¢ Conectar GitHub: <code>git remote add origin URL && git push</code><br><br><strong>2. Desarrollo Iterativo (ciclo diario)</strong><br>‚Ä¢ Activar entorno ‚Üí Escribir c√≥digo ‚Üí Probar ‚Üí Commit at√≥mico ‚Üí Push<br>‚Ä¢ Usar decoradores para validar supuestos estad√≠sticos<br>‚Ä¢ Actualizar <code>requirements.txt</code> al a√±adir dependencias<br><br><strong>3. Entrega/Publicaci√≥n</strong><br>‚Ä¢ Crear tag de versi√≥n: <code>git tag -a v1.0 -m 'Entrega final'</code><br>‚Ä¢ Opcional: Crear Dockerfile para reproducibilidad total<br>‚Ä¢ Compartir: repositorio + requirements.txt (o imagen Docker)",
                            analogy: "üéØ <strong>El estad√≠stico moderno:</strong> Domina tanto la teor√≠a estad√≠stica como las herramientas de ingenier√≠a de software. Esto no significa convertirse en programador, sino adoptar pr√°cticas que garantizan que tus an√°lisis sean <strong>reproducibles</strong>, <strong>versionados</strong>, y <strong>validados autom√°ticamente</strong>. Un an√°lisis que no se puede reproducir es, cient√≠ficamente, un an√°lisis que no existe.",
                            warning: " <strong>Checklist antes de entregar cualquier an√°lisis:</strong><br>‚òê ¬øEl c√≥digo corre desde cero en un entorno limpio?<br>‚òê ¬øExiste requirements.txt o environment.yml actualizado?<br>‚òê ¬øLos datos sensibles est√°n en .gitignore?<br>‚òê ¬øHay commits descriptivos (no 'cambios finales')?<br>‚òê ¬øSe verifican supuestos estad√≠sticos antes de cada test?<br>‚òê ¬øEl repositorio est√° sincronizado con GitHub?"
                        },
                        comparison: [
                            { tool: "Python 3.11+", use: "Rendimiento", detail: "Pattern matching, mejor velocidad, mensajes de error claros. Base s√≥lida para an√°lisis modernos.", icon: "üêç" },
                            { tool: "venv/conda", use: "Aislamiento", detail: "Entornos reproducibles. requirements.txt para compartir. Evita conflictos de dependencias.", icon: "üì¶" },
                            { tool: "Docker", use: "Reproducibilidad Total", detail: "Empaqueta SO + Python + libs. Ideal para papers y producci√≥n.", icon: "üê≥" },
                            { tool: "Git + GitHub", use: "Versionado y Respaldo", detail: "Historial de cambios, colaboraci√≥n, respaldo en nube. Esencial para cualquier proyecto.", icon: "üìã" },
                            { tool: "Decoradores", use: "Validaci√≥n Autom√°tica", detail: "Verifican supuestos antes de ejecutar tests. C√≥digo DRY y robusto.", icon: "üõ°Ô∏è" }
                        ],
                        code: {
                            title: "Plantilla: Inicio de Proyecto de An√°lisis",
                            snippet: `# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# SCRIPT DE INICIO R√ÅPIDO PARA NUEVO PROYECTO
# Copia y ejecuta estos comandos en tu terminal
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# 1. Crear estructura de carpetas
mkdir mi_proyecto_tesis
cd mi_proyecto_tesis
mkdir datos scripts outputs figuras

# 2. Inicializar Git
git init

# 3. Crear .gitignore
cat > .gitignore << 'EOF'
# Datos (no subir a GitHub)
datos/
*.csv
*.xlsx
*.parquet

# Outputs regenerables
outputs/
figuras/
*.png
*.pdf

# Entornos
venv/
env/
.env
*.pyc
__pycache__/

# Sistema
.DS_Store
Thumbs.db
EOF

# 4. Crear entorno virtual
python -m venv env
source env/bin/activate  # Windows: env\\Scripts\\activate

# 5. Instalar dependencias base
pip install pandas numpy scipy matplotlib statsmodels
pip freeze > requirements.txt

# 6. Crear archivo principal
cat > scripts/analisis_principal.py << 'EOF'
"""
An√°lisis Principal - Mi Proyecto
Autor: Tu Nombre
Fecha: $(date +%Y-%m-%d)
"""
import pandas as pd
import numpy as np
from scipy import stats

def main():
    # Tu c√≥digo aqu√≠
    print("Proyecto iniciado correctamente")

if __name__ == "__main__":
    main()
EOF

# 7. Primer commit
git add .
git commit -m "Estructura inicial del proyecto"

# 8. Conectar con GitHub (reemplaza URL)
# git remote add origin https://github.com/usuario/mi_proyecto.git
# git push -u origin main

echo "‚úÖ Proyecto listo para trabajar"`,
                            output: "‚úÖ Proyecto listo para trabajar\\nüìÅ Estructura: datos/ scripts/ outputs/ figuras/\\nüêç Entorno: env/ activado\\nüìã Git: Repositorio inicializado"
                        },
                        resources: [
                            { name: "Real Python - Virtual Environments", desc: "Gu√≠a completa de entornos virtuales en Python.", url: "https://realpython.com/python-virtual-environments-a-primer/" },
                            { name: "Git - Pro Git Book (Espa√±ol)", desc: "Libro oficial de Git, gratuito y en espa√±ol.", url: "https://git-scm.com/book/es/v2" },
                            { name: "Docker para Data Science (DataCamp)", desc: "Tutorial completo de Docker para proyectos de datos.", url: "https://www.datacamp.com/tutorial/docker-for-data-science-introduction" },
                            { name: "Scipy Lecture Notes", desc: "Tutoriales del stack cient√≠fico Python (NumPy, Pandas, Scipy).", url: "https://scipy-lectures.org/" },
                            { name: "The Missing Semester (MIT)", desc: "Curso de MIT sobre herramientas esenciales: Git, Shell, etc.", url: "https://missing.csail.mit.edu/" }
                        ],
                        chartData: {
                            type: 'radar',
                            label: 'Competencias Desarrolladas',
                            labels: ['Rendimiento (Py3.11)', 'Aislamiento (Venv/Conda)', 'Contenedores (Docker)', 'Control Versiones (Git)', 'Validaci√≥n (Decoradores)'],
                            data: [85, 90, 70, 80, 85],
                            description: "Mapa de competencias t√©cnicas cubiertas en este curso."
                        }
                    }
                }
            ]
        };


        // --- DOM REFERENCES ---
        const pipelineContainer = document.getElementById('pipeline-container');
        const moduleNav = document.getElementById('module-nav');
        const contentArea = document.getElementById('content-area');

        // --- STATE MANAGMENT ---
        let currentModuleIndex = 0;
        let completedModules = new Set();

        // --- INIT ---
        function init() {
            renderPipeline();
            renderNav();
            loadModule(0);
            startTimer();
        }

        // --- RENDERING ---
        function renderPipeline() {
            pipelineContainer.innerHTML = '';
            courseData.modules.forEach((mod, index) => {
                const step = document.createElement('div');
                step.className = `relative flex flex-col items-center z-10 flex-1 step-connector cursor-pointer group`;
                if (index === courseData.modules.length - 1) step.classList.remove('step-connector');

                // State classes
                const isActive = index === currentModuleIndex;
                const isDone = completedModules.has(index);

                step.innerHTML = `
                    <div class="step-circle w-10 h-10 rounded-full flex items-center justify-center border-2 bg-white transition-all duration-300 
                        ${isActive ? 'border-orange-600 bg-orange-600 text-white shadow-lg scale-110' :
                        isDone ? 'border-emerald-500 bg-emerald-500 text-white' : 'border-gray-300 text-gray-400 group-hover:border-gray-400'}">
                        ${isDone ? '‚úì' : index + 1}
                    </div>
                    <span class="mt-2 text-xs font-semibold ${isActive ? 'text-orange-700' : 'text-gray-500'}">
                        ${mod.shortTitle}
                    </span>
                `;

                step.onclick = () => loadModule(index);
                pipelineContainer.appendChild(step);
            });
        }

        function renderNav() {
            moduleNav.innerHTML = '';
            courseData.modules.forEach((mod, index) => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors mb-1 flex items-center justify-between
                    ${index === currentModuleIndex
                        ? 'bg-orange-50 text-orange-700 border border-orange-200'
                        : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'}`;

                btn.innerHTML = `
                    <span>${mod.title}</span>
                    ${completedModules.has(index) ? '<span class="text-emerald-500">‚úì</span>' : ''}
                `;
                btn.onclick = () => loadModule(index);
                moduleNav.appendChild(btn);
            });
        }

        function loadModule(index) {
            currentModuleIndex = index;
            renderPipeline();
            renderNav();

            const mod = courseData.modules[index];

            // Generate HTML based on module content
            let contentHTML = `
                <div class="animate-fade-in space-y-8">
                    <!-- Header -->
                    <div class="border-b border-gray-100 pb-6">
                        <div class="flex items-center space-x-2 text-sm text-orange-600 font-semibold mb-2 uppercase tracking-wide">
                            <span>M√≥dulo ${index + 1}</span>
                        </div>
                        <h2 class="text-3xl font-bold text-gray-900 mb-4">${mod.title}</h2>
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200 flex items-start gap-3">
                            <span class="text-xl">üéØ</span>
                            <div>
                                <h3 class="font-bold text-gray-800 text-sm">Objetivo</h3>
                                <p class="text-gray-600 text-sm">${mod.objective}</p>
                            </div>
                        </div>
                    </div>

                    <!-- Concept Section -->
                    <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 space-y-4">
                            <h3 class="text-xl font-bold text-gray-800">${mod.content.concept.title}</h3>
                            <p class="text-gray-600 leading-relaxed">${mod.content.concept.text}</p>
                            ${mod.content.concept.analogy ? `
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r text-sm text-blue-800" role="note">
                                ${mod.content.concept.analogy}
                            </div>` : ''}
                            ${mod.content.concept.warning ? `
                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-r text-sm text-yellow-800" role="alert">
                                ${mod.content.concept.warning}
                            </div>` : ''}
                        </div>
            `;

            // Comparison / Visual Comparison Section
            if (mod.content.comparison || mod.content.visualComparison) {
                const comparisons = mod.content.comparison || mod.content.visualComparison;
                contentHTML += `
                    <div class="lg:col-span-1 space-y-3">
                         <div class="text-xs font-bold text-gray-400 text-center uppercase">Comparativa</div>
                         ${comparisons.map(c => `
                            <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-xl">${c.icon || (c.title.includes('GET') ? 'üîç' : c.title.includes('POST') ? 'üìù' : '‚ö°')}</span>
                                    <span class="font-bold text-gray-800">${c.title || c.tool}</span>
                                </div>
                                ${c.use ? `<div class="text-xs font-semibold text-orange-600 mb-1">${c.use}</div>` : ''}
                                ${c.pros ? `<ul class="text-xs text-green-700 list-disc ml-4 mb-1">${c.pros.map(p => `<li>${p}</li>`).join('')}</ul>` : ''}
                                ${c.cons ? `<ul class="text-xs text-red-700 list-disc ml-4">${c.cons.map(p => `<li>${p}</li>`).join('')}</ul>` : ''}
                                ${c.detail ? `<p class="text-xs text-gray-500">${c.detail}</p>` : ''}
                            </div>
                         `).join('')}
                    </div>
                `;
            } else if (mod.content.chartData && !mod.content.resources) {
                contentHTML += `
                    <div class="lg:col-span-1 bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex flex-col justify-center">
                        <div class="text-xs font-bold text-gray-400 text-center mb-2 uppercase">Visualizaci√≥n de Datos</div>
                        <div class="chart-container">
                            <canvas id="moduleChart"></canvas>
                        </div>
                        <p class="text-xs text-center text-gray-500 mt-2 italic">${mod.content.chartData.description}</p>
                    </div>
                `;
            } else {
                contentHTML += `<div class="lg:col-span-1"></div>`; // Placeholder to keep grid layout
            }

            contentHTML += `</section>`;

            // Code Section (collapsible + syntax highlighting)
            if (mod.content.code) {
                contentHTML += `
                    <section class="bg-gray-900 rounded-xl overflow-hidden shadow-lg border border-gray-700">
                        <details open>
                            <summary class="bg-gray-800 px-4 py-2 flex items-center justify-between border-b border-gray-700 cursor-pointer select-none list-none hover:bg-gray-750 transition-colors">
                                <div class="flex items-center gap-2">
                                    <span class="code-toggle-arrow text-gray-400 text-xs transition-transform">‚ñ∂</span>
                                    <span class="text-gray-300 text-xs font-mono">main.py</span>
                                    <span class="text-xs text-gray-500 ml-2">${mod.content.code.title}</span>
                                </div>
                                <span class="text-xs text-gray-500">Python 3.11</span>
                            </summary>
                            <div class="p-6 overflow-x-auto code-scroll">
                                <pre class="!m-0 !p-0 !bg-transparent"><code id="code-block" class="language-python hljs">${escapeHtml(mod.content.code.snippet)}</code></pre>
                            </div>
                        </details>
                        <div class="bg-black bg-opacity-50 p-4 border-t border-gray-800 flex items-center justify-between">
                            <button onclick="runSimulation('${mod.id}')" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded text-sm font-medium flex items-center gap-2 transition-colors">
                                <span>‚ñ∂ Ejecutar C√≥digo</span>
                            </button>
                            <div id="output-${mod.id}" class="hidden font-mono text-xs text-emerald-400 bg-gray-900 px-3 py-2 rounded border border-gray-700 w-2/3">
                                >_ Esperando ejecuci√≥n...
                            </div>
                        </div>
                    </section>
                `;
            }

            // Code Explanation Section (New for Semana II)
            if (mod.content.codeExplanation) {
                contentHTML += `
                    <section class="mt-6">
                        <h3 class="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2">
                             <i class="fas fa-search-plus text-primary"></i> ${mod.content.codeExplanation.title}
                        </h3>
                        <div class="space-y-4">
                            ${mod.content.codeExplanation.steps.map((step, i) => `
                                <div class="flex gap-4">
                                    <div class="flex-shrink-0 w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-sm">
                                        ${i + 1}
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-gray-800 text-sm">${step.title}</h4>
                                        <p class="text-sm text-gray-600">${step.text}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </section>
                `;
            }

            // Quizzes Section (Handling Multiple)
            if (mod.content.quizzes) {
                contentHTML += `<div class="space-y-6">`;
                mod.content.quizzes.forEach((quiz, index) => {
                    contentHTML += `
                        <section class="bg-orange-50 rounded-xl p-6 border border-orange-100">
                            <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                                <span class="bg-orange-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">?</span>
                                Checkpoint ${index + 1}
                            </h3>
                            <p class="text-gray-700 font-medium mb-4">${quiz.question}</p>
                            <div class="space-y-2" id="quiz-options-${mod.id}-${index}" role="radiogroup">
                                ${quiz.options.map((opt, i) => `
                                    <button onclick="checkAnswer(${i}, ${quiz.correct}, '${mod.id}', ${index})" 
                                        class="quiz-opt-btn w-full text-left p-3 rounded bg-white border border-orange-200 hover:bg-orange-100 transition-colors text-sm text-gray-700">
                                        ${opt}
                                    </button>
                                `).join('')}
                            </div>
                            <div id="quiz-feedback-${mod.id}-${index}" class="hidden mt-4 p-3 rounded text-sm font-medium"></div>
                        </section>
                    `;
                });
                contentHTML += `</div>`;
            }

            // Glossary Section (New for Semana II)
            if (mod.content.glossary) {
                contentHTML += `
                    <section class="mt-8 usta-card p-6">
                         <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <span class="usta-gradient text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">
                                <i class="fas fa-book text-xs"></i>
                            </span>
                            ${mod.content.glossary.title}
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${mod.content.glossary.items.map(item => `
                                <div class="bg-gray-50 p-3 rounded-lg border border-gray-200">
                                    <span class="font-bold text-primary block mb-1">${item.term}</span>
                                    <p class="text-xs text-gray-600">${item.definition}</p>
                                </div>
                            `).join('')}
                        </div>
                         ${mod.content.glossary.conceptualExample ? `
                            <div class="mt-4 p-4 bg-gray-100 rounded-lg">
                                <h4 class="font-bold text-sm text-gray-800 mb-2">${mod.content.glossary.conceptualExample.title}</h4>
                                <p class="text-xs text-gray-600 mb-3">${mod.content.glossary.conceptualExample.description}</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <pre class="bg-red-50 text-red-800 p-2 rounded text-xs overflow-x-auto code-font">${mod.content.glossary.conceptualExample.codeOld}</pre>
                                    <pre class="bg-green-50 text-green-800 p-2 rounded text-xs overflow-x-auto code-font">${mod.content.glossary.conceptualExample.codeNew}</pre>
                                </div>
                            </div>
                        ` : ''}
                    </section>
                `;
            }

            // Chart Section (Synthesis)
            if (mod.content.chartData && mod.content.resources) {
                contentHTML += `
                    <section class="mt-8 usta-card p-6">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <span class="usta-gradient text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">
                                <i class="fas fa-chart-pie text-xs"></i>
                            </span>
                            Competencias Desarrolladas
                        </h3>
                        <div class="flex flex-col md:flex-row items-center gap-6">
                            <div class="w-full md:w-1/2" style="height: 320px;">
                                <canvas id="moduleChart"></canvas>
                            </div>
                            <div class="w-full md:w-1/2">
                                <p class="text-sm text-gray-600 mb-4">${mod.content.chartData.description}</p>
                                <div class="space-y-2">
                                    ${mod.content.chartData.labels.map((label, i) => `
                                        <div class="flex items-center justify-between text-sm">
                                            <span class="text-gray-700">${label}</span>
                                            <div class="flex items-center gap-2">
                                                <div class="w-32 h-2 bg-gray-200 rounded-full overflow-hidden">
                                                    <div class="h-full usta-gradient rounded-full" style="width: ${mod.content.chartData.data[i]}%"></div>
                                                </div>
                                                <span class="text-xs font-bold text-primary">${mod.content.chartData.data[i]}%</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }

            // Resources (Synthesis)
            if (mod.content.resources) {
                contentHTML += `
                    <section class="mt-8">
                        <h3 class="font-bold text-gray-900 mb-4 flex items-center gap-2">
                            <span class="usta-gradient text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">
                                <i class="fas fa-rocket text-xs"></i>
                            </span>
                            Pr√≥ximos Pasos
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            ${mod.content.resources.map(res => `
                                <a href="${res.url}" target="_blank" rel="noopener noreferrer" class="block p-4 rounded-lg border border-gray-200 hover:border-secondary hover:shadow-md transition-all group" aria-label="Recurso externo: ${res.name}">
                                    <div class="font-bold text-gray-800 group-hover:text-secondary mb-1">${res.name} <span class="text-xs">‚Üó</span></div>
                                    <div class="text-xs text-gray-500">${res.desc}</div>
                                </a>
                            `).join('')}
                        </div>
                    </section>
                `;
            }

            // Navigation buttons
            contentHTML += `
                <div class="mt-10 pt-6 border-t border-gray-200 flex justify-between items-center">
                    ${index > 0 ? `
                    <button onclick="loadModule(${index - 1})" class="flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 hover:text-orange-600 transition-colors" aria-label="Ir al m√≥dulo anterior">
                        <span>‚Üê</span> Anterior
                    </button>` : '<div></div>'}
                    ${index < courseData.modules.length - 1 ? `
                    <button onclick="loadModule(${index + 1})" class="flex items-center gap-2 px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg text-sm font-medium transition-colors" aria-label="Ir al siguiente m√≥dulo">
                        Siguiente M√≥dulo <span>‚Üí</span>
                    </button>` : `
                    <div class="text-center">
                        <span class="text-emerald-600 font-bold">üéâ Sesi√≥n Completada!</span>
                    </div>`}
                </div>
            `;

            contentHTML += `</div>`; // Close fade-in wrapper
            contentArea.innerHTML = contentHTML;

            // Apply syntax highlighting
            const codeEl = document.getElementById('code-block');
            if (codeEl && typeof hljs !== 'undefined') {
                hljs.highlightElement(codeEl);
            }

            // Initialize Chart if needed
            if (mod.content.chartData) {
                renderChart(mod.content.chartData);
            }
        }

        // --- INTERACTION LOGIC ---

        function runSimulation(modId) {
            const outputDiv = document.getElementById(`output-${modId}`);
            const mod = courseData.modules.find(m => m.id === modId);

            outputDiv.innerHTML = "<span class='animate-pulse'>Procesando...</span>";
            outputDiv.classList.remove('hidden');

            setTimeout(() => {
                outputDiv.innerHTML = `>_ ${mod.content.code.output.replace(/\n/g, '<br>>_ ')}`;
                outputDiv.classList.remove('text-emerald-400', 'bg-gray-900');
                outputDiv.classList.add('bg-black', 'text-green-400'); // Terminal look
            }, 800);
        }

        function checkAnswer(selectedIdx, correctIdx, modId, quizIndex) {
            const feedbackDiv = document.getElementById(`quiz-feedback-${modId}-${quizIndex}`);
            const buttons = document.querySelectorAll(`#quiz-options-${modId}-${quizIndex} button`);
            const mod = courseData.modules.find(m => m.id === modId);
            const quiz = mod.content.quizzes[quizIndex];

            buttons.forEach((btn, idx) => {
                btn.disabled = true;
                if (idx === correctIdx) {
                    btn.classList.remove('bg-white', 'border-orange-200');
                    btn.classList.add('bg-emerald-100', 'border-emerald-500', 'text-emerald-800');
                } else if (idx === selectedIdx) {
                    btn.classList.remove('bg-white', 'border-orange-200');
                    btn.classList.add('bg-red-100', 'border-red-500', 'text-red-800');
                }
            });

            feedbackDiv.classList.remove('hidden');
            if (selectedIdx === correctIdx) {
                feedbackDiv.className = "mt-4 p-3 rounded text-sm font-medium bg-emerald-50 text-emerald-800 border border-emerald-200";
                feedbackDiv.innerHTML = quiz.feedback;
                // Mark module as complete if all quizzes in module are correct? For now just simplest logic:
                // We'll mark as complete if it's the last quiz? Or just mark it.
                // Simple logic: if user attempts and gets right, we consider it progress.

                // Only mark visual progress for module if this is the last quiz or if there's only 1.
                // But simplified: just mark if not marked.
                const modIdx = courseData.modules.findIndex(m => m.id === modId);
                if (!completedModules.has(modIdx)) {
                    completedModules.add(modIdx);
                    renderPipeline(); // Update visual progress
                    renderNav();
                }
            } else {
                feedbackDiv.className = "mt-4 p-3 rounded text-sm font-medium bg-red-50 text-red-800 border border-red-200";
                feedbackDiv.innerHTML = "‚ùå Incorrecto. Revisa el concepto clave e intenta de nuevo.";
                // Re-enable after delay
                setTimeout(() => {
                    buttons.forEach(btn => {
                        btn.disabled = false;
                        btn.className = "quiz-opt-btn w-full text-left p-3 rounded bg-white border border-orange-200 hover:bg-orange-100 transition-colors text-sm text-gray-700";
                    });
                    feedbackDiv.classList.add('hidden');
                }, 2500);
            }
        }

        function renderChart(data) {
            const ctx = document.getElementById('moduleChart').getContext('2d');

            // Common Options
            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: data.type === 'radar' },
                }
            };

            if (data.type === 'bar') {
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.labels,
                        datasets: [{
                            label: data.label,
                            data: data.data,
                            backgroundColor: ['#E5E7EB', '#D1D5DB', '#EA580C'],
                            borderRadius: 4
                        }]
                    },
                    options: {
                        ...commonOptions,
                        scales: {
                            y: { beginAtZero: true, title: { display: true, text: 'Valor' } }
                        }
                    }
                });
            } else if (data.type === 'radar') {
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: data.labels,
                        datasets: [{
                            label: 'Competencias',
                            data: data.data,
                            backgroundColor: 'rgba(61, 0, 141, 0.15)',
                            borderColor: '#3D008D',
                            pointBackgroundColor: '#ED1E79',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: '#ED1E79',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        ...commonOptions,
                        scales: {
                            r: {
                                angleLines: { display: true, color: 'rgba(0,0,0,0.1)' },
                                suggestedMin: 0,
                                suggestedMax: 100,
                                ticks: { backdropColor: 'transparent' }
                            }
                        }
                    }
                });
            }
        }

        function startTimer() {
            let mins = 120;
            const timeDisplay = document.getElementById('time-remaining');
            setInterval(() => {
                if (mins > 0) {
                    mins--;
                    if (timeDisplay) timeDisplay.innerText = mins;
                }
            }, 60000);
        }

        function escapeHtml(text) {
            if (!text) return '';
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // Start App
        init();

        // Scroll to Top Button
        const scrollToTopBtn = document.getElementById('scrollToTopBtn');

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollToTopBtn.classList.add('visible');
            } else {
                scrollToTopBtn.classList.remove('visible');
            }
        });

        scrollToTopBtn.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

    </script>
</body>

</html>